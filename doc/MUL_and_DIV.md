# **乘除法器设计**


乘法器采用Booth-2位乘法器的设计思路，除法器采用一位恢复余数绝对值除法，同时乘除法器在内部会对有符号乘法与无符号乘法进行处理，无需分别构建有符号乘除法器与无符号乘除法器，设计的思路可以查看[一生一芯](https://ysyx.oscc.cc/docs/advanced/2.8.html)关于这部分的介绍，同时本项目中乘除法器的端口也与**一生一芯**的介绍中保持一致。

除此之外，本项目中的乘除法器使用chisel进行了初始的设计与单元测试，项目中的verilog代码是通过scala编译得到的，但是我也在代码后面附上了原始的scala代码。

## 本项目提供两种乘法器实现
 其中 一种是基4 Booth乘法器，一种是华莱士树乘法器，Booth乘法器较为简单，采用移位寄存器实现，计算一次乘法结果需要18个周期；华莱士树乘法器采用基-4 Booth展开成部分积，再使用华莱士树压缩部分积，目前每次计算32-bit乘法需要两个周期。
 
 只需要在EXE.v文件中找到乘法器实例化的地方，修改注释就能十分方便地实现两种乘法器的切换。Booth_MUL为简单的基-4 Booth乘法器，Booth_Walloc_MUL为华莱士树实现的高性能乘法器。
 
## **关于仿真速度**
 可能在使用了高性能的乘法器之后仿真速度反而下降了，这是因为在verilator仿真环境，每一个verilog电路信号的跳变都需要使用c语言去描述，而高性能乘法器往往是用面积换时间的设计，因此在verilator的仿真下可能需要更多的c语言代码去仿真复杂的乘法器，因此在使用高性能乘法器时仿真速度可能反而会变慢。
 
 
 
 
